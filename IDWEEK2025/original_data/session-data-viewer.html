<!DOCTYPE html>
<html>
<head>
    <title>IDWeek 2025 Sessions Data Viewer</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .stats { background: #e8f4fd; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
        .session { border: 1px solid #ddd; margin: 10px 0; padding: 15px; border-radius: 5px; }
        .session-title { font-weight: bold; color: #2c5aa0; font-size: 18px; margin-bottom: 5px; }
        .session-meta { color: #666; margin: 5px 0; }
        .session-speakers { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 3px; }
        .session-presentations { background: #fff3cd; padding: 10px; margin: 10px 0; border-radius: 3px; }
        .filter-box { margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px; }
        .filter-box input, .filter-box select { margin: 5px; padding: 8px; border: 1px solid #ccc; border-radius: 3px; }
        .hidden { display: none; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; font-size: 12px; border-radius: 3px; }
        .toggle-raw { background: #6c757d; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1>IDWeek 2025 Sessions Data Viewer</h1>
        
        <div class="stats" id="stats">
            <strong>Loading sessions...</strong>
        </div>
        
        <div class="filter-box">
            <input type="text" id="searchFilter" placeholder="Search sessions..." style="width: 300px;">
            <select id="typeFilter">
                <option value="">All Session Types</option>
            </select>
            <button onclick="clearFilters()">Clear Filters</button>
        </div>
        
        <div id="sessions">Loading sessions...</div>
    </div>
    
    <script>
        let allSessions = [];
        let filteredSessions = [];
        
        function clearFilters() {
            document.getElementById('searchFilter').value = '';
            document.getElementById('typeFilter').value = '';
            displaySessions(allSessions);
        }
        
        function applyFilters() {
            const searchTerm = document.getElementById('searchFilter').value.toLowerCase();
            const typeFilter = document.getElementById('typeFilter').value;
            
            filteredSessions = allSessions.filter(session => {
                const matchesSearch = !searchTerm || 
                    (session.session_info?.title || '').toLowerCase().includes(searchTerm) ||
                    (session.schedule?.location || '').toLowerCase().includes(searchTerm) ||
                    (session.speakers || []).some(s => (s.name || '').toLowerCase().includes(searchTerm));
                    
                const matchesType = !typeFilter || (session.session_info?.type || '') === typeFilter;
                
                return matchesSearch && matchesType;
            });
            
            displaySessions(filteredSessions);
        }
        
        function displaySessions(sessions) {
            const container = document.getElementById('sessions');
            
            if (sessions.length === 0) {
                container.innerHTML = '<p>No sessions found.</p>';
                return;
            }
            
            container.innerHTML = sessions.map((session, index) => {
                const sessionInfo = session.session_info || {};
                const schedule = session.schedule || {};
                const speakers = session.speakers || [];
                const presentations = session.presentations || [];
                
                return `
                    <div class="session">
                        <div class="session-title">
                            ${sessionInfo.type || 'Unknown'}: ${sessionInfo.title || 'No title'}
                        </div>
                        <div class="session-meta">
                            <strong>ID:</strong> ${session.session_id || 'N/A'} | 
                            <strong>Date:</strong> ${schedule.date || 'TBD'} | 
                            <strong>Time:</strong> ${schedule.time || 'TBD'} | 
                            <strong>Location:</strong> ${schedule.location || 'TBD'}
                        </div>
                        
                        ${speakers.length > 0 ? `
                            <div class="session-speakers">
                                <strong>Speakers (${speakers.length}):</strong><br>
                                ${speakers.map(s => `${s.name || 'Unknown'} - ${s.institution || ''}`).join('<br>')}
                            </div>
                        ` : ''}
                        
                        ${presentations.length > 0 ? `
                            <div class="session-presentations">
                                <strong>Presentations (${presentations.length}):</strong><br>
                                ${presentations.map(p => `â€¢ ${p.title || 'Untitled'} (${p.time || 'Time TBD'})`).join('<br>')}
                            </div>
                        ` : ''}
                        
                        <button class="toggle-raw" onclick="toggleRaw(${index})">Toggle Raw JSON</button>
                        <pre id="raw-${index}" class="hidden">${JSON.stringify(session, null, 2)}</pre>
                    </div>
                `;
            }).join('');
        }
        
        function toggleRaw(index) {
            const element = document.getElementById('raw-' + index);
            element.classList.toggle('hidden');
        }
        
        // Load and display data
        fetch('idweek2025_sessions.json')
            .then(response => response.json())
            .then(data => {
                allSessions = data;
                filteredSessions = data;
                
                // Update stats
                document.getElementById('stats').innerHTML = `
                    <strong>Total Sessions:</strong> ${data.length} | 
                    <strong>Session Types:</strong> ${[...new Set(data.map(s => s.session_info?.type).filter(Boolean))].length} | 
                    <strong>Total Speakers:</strong> ${data.reduce((sum, s) => sum + (s.speakers?.length || 0), 0)}
                `;
                
                // Populate type filter
                const types = [...new Set(data.map(s => s.session_info?.type).filter(Boolean))].sort();
                const typeSelect = document.getElementById('typeFilter');
                types.forEach(type => {
                    const option = document.createElement('option');
                    option.value = type;
                    option.textContent = type;
                    typeSelect.appendChild(option);
                });
                
                // Display sessions
                displaySessions(data);
                
                // Add event listeners
                document.getElementById('searchFilter').addEventListener('input', applyFilters);
                document.getElementById('typeFilter').addEventListener('change', applyFilters);
            })
            .catch(error => {
                document.getElementById('sessions').innerHTML = `<p>Error loading data: ${error}</p>`;
            });
    </script>
</body>
</html>